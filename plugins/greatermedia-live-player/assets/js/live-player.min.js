!function(a,b){"undefined"!=typeof module&&module.exports?module.exports.browser=b():"function"==typeof define&&define.amd?define(b):this.bowser=b()}(0,function(){function a(a){function c(b){var c=a.match(b);return c&&c.length>1&&c[1]||""}var d,e=c(/(ipod|iphone|ipad)/i).toLowerCase(),f=/like android/i.test(a),g=!f&&/android/i.test(a),h=c(/version\/(\d+(\.\d+)?)/i),i=/tablet/i.test(a),j=!i&&/[^-]mobi/i.test(a);/opera|opr/i.test(a)?d={name:"Opera",opera:b,version:h||c(/(?:opera|opr)[\s\/](\d+(\.\d+)?)/i)}:/windows phone/i.test(a)?d={name:"Windows Phone",windowsphone:b,msie:b,version:c(/iemobile\/(\d+(\.\d+)?)/i)}:/msie|trident/i.test(a)?d={name:"Internet Explorer",msie:b,version:c(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:/chrome|crios|crmo/i.test(a)?d={name:"Chrome",chrome:b,version:c(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:e?(d={name:"iphone"==e?"iPhone":"ipad"==e?"iPad":"iPod"},h&&(d.version=h)):/sailfish/i.test(a)?d={name:"Sailfish",sailfish:b,version:c(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(a)?d={name:"SeaMonkey",seamonkey:b,version:c(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel/i.test(a)?(d={name:"Firefox",firefox:b,version:c(/(?:firefox|iceweasel)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(a)&&(d.firefoxos=b)):/silk/i.test(a)?d={name:"Amazon Silk",silk:b,version:c(/silk\/(\d+(\.\d+)?)/i)}:g?d={name:"Android",version:h}:/phantom/i.test(a)?d={name:"PhantomJS",phantom:b,version:c(/phantomjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(a)||/rim\stablet/i.test(a)?d={name:"BlackBerry",blackberry:b,version:h||c(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:/(web|hpw)os/i.test(a)?(d={name:"WebOS",webos:b,version:h||c(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(a)&&(d.touchpad=b)):d=/bada/i.test(a)?{name:"Bada",bada:b,version:c(/dolfin\/(\d+(\.\d+)?)/i)}:/tizen/i.test(a)?{name:"Tizen",tizen:b,version:c(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||h}:/safari/i.test(a)?{name:"Safari",safari:b,version:h}:{},/(apple)?webkit/i.test(a)?(d.name=d.name||"Webkit",d.webkit=b,!d.version&&h&&(d.version=h)):!d.opera&&/gecko\//i.test(a)&&(d.name=d.name||"Gecko",d.gecko=b,d.version=d.version||c(/gecko\/(\d+(\.\d+)?)/i)),g||d.silk?d.android=b:e&&(d[e]=b,d.ios=b);var k="";e?(k=c(/os (\d+([_\s]\d+)*) like mac os x/i),k=k.replace(/[_\s]/g,".")):g?k=c(/android[ \/-](\d+(\.\d+)*)/i):d.windowsphone?k=c(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):d.webos?k=c(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):d.blackberry?k=c(/rim\stablet\sos\s(\d+(\.\d+)*)/i):d.bada?k=c(/bada\/(\d+(\.\d+)*)/i):d.tizen&&(k=c(/tizen[\/\s](\d+(\.\d+)*)/i)),k&&(d.osversion=k);var l=k.split(".")[0];return i||"ipad"==e||g&&(3==l||4==l&&!j)||d.silk?d.tablet=b:(j||"iphone"==e||"ipod"==e||g||d.blackberry||d.webos||d.bada)&&(d.mobile=b),d.msie&&d.version>=10||d.chrome&&d.version>=20||d.firefox&&d.version>=20||d.safari&&d.version>=6||d.opera&&d.version>=10||d.ios&&d.osversion&&d.osversion.split(".")[0]>=6||d.blackberry&&d.version>=10.1?d.a=b:d.msie&&d.version<10||d.chrome&&d.version<20||d.firefox&&d.version<20||d.safari&&d.version<6||d.opera&&d.version<10||d.ios&&d.osversion&&d.osversion.split(".")[0]<6?d.c=b:d.x=b,d}var b=!0,c=a("undefined"!=typeof navigator?navigator.userAgent:"");return c._detect=a,c}),function(a,b,c,d){"use strict";function e(a){sa("tdplayer::play: "+a),za.play({station:a,timeShift:!0}),Ha.trigger("player:starts")}function f(a,b,c){null!=a&&(a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c))}function g(){var b=gmr.intervals.live_streaming;b>0&&(sa("Live stream interval set"),ab=setInterval(function(){a(La).trigger("liveStreamPlaying.gmr"),sa("Live stream interval reached")},60*b*1e3))}function h(){var b=gmr.intervals.inline_audio;b>0&&(sa("Inline audio interval set"),_a=setInterval(function(){a(La).trigger("inlineAudioPlaying.gmr"),sa("Inline audio interval reached")},60*b*1e3))}function i(){clearInterval(ab),sa("Live stream interval off")}function j(){clearInterval(_a),sa("Inline audio interval off")}function k(){return bowser.firefox?["Flash","Html5"]:bowser.safari?["Html5","Flash"]:(bowser.chrome,["Html5","Flash"])}function l(){var a,d=c.getElementById("td_container");d&&(a=k(),sa("+++ initPlayer - techPriority = "+a.join(", ")),b.player=za=new TDSdk({coreModules:[{id:"MediaPlayer",playerId:"td_container",isDebug:!1,techPriority:a,timeShift:{active:0,max_listening_time:35},geoTargeting:{desktop:{isActive:!1},iOS:{isActive:!1},android:{isActive:!1}},plugins:[{id:"vastAd"}]},{id:"NowPlayingApi"},{id:"Npe"},{id:"PlayerWebAdmin"},{id:"SyncBanners",elements:[{id:b.innerWidth>=768?"js-audio-ad-inplayer":"js-audio-ad-aboveplayer",width:320,height:50}]},{id:"TargetSpot"}],playerReady:I,configurationError:ha,moduleError:ia}))}function m(){null!=Qa&&f(Qa,"click",G),null!=Ra&&f(Ra,"click",F),pb.click(F)}function n(){null!==Ma&&(Ma.classList.add("stream__active"),!0===Ia&&b.innerWidth<=767?Pa.classList.add("live-player__login"):Pa.classList.add("live-player__muted"),Ra.classList.contains("live-player__muted")||Ra.classList.add("live-player__muted"),Ra.classList.contains("resume__live")&&Ra.classList.remove("resume__live"),hb.removeClass("-show"),eb.removeClass("-playing -paused -loading"),a(Xa).addClass("-show"),a(Wa).text("On Air"),!0===Ia?(lb.addClass("-show"),eb.addClass("-playing"),a(".audio-stream .audio-stream__title").text("SWITCH TO LIVE STREAM")):(lb.removeClass("-show"),a(".audio-stream .audio-stream__title").each(function(){var b=a(this),c=a.trim(b.attr("data-callsign")),d=a.trim(a('.audio-stream__link[data-callsign="'+c+'"] .audio-stream__desc').text());b.text(d&&d.length>0?d:c)})),!1===Ia&&null!=Sa&&Sa.classList.add("loading"),!0===Ia&&null!=Qa?Qa.classList.contains("live-player__muted")&&Qa.classList.remove("live-player__muted"):Qa.classList.add("live-player__muted"))}function o(){null!==Ma&&(eb.removeClass("-playing -loading -paused"),hb.removeClass("-show"),V(),Ra.classList.contains("live-player__muted")&&(Ra.classList.remove("live-player__muted"),Ra.classList.add("resume__live")),a(Wa).addClass("-show").text("Listen Live"),a(Xa).removeClass("-show"),Qa.classList.add("live-player__muted"),$())}function p(){null!==Ma&&(Ia||hb.addClass("-show"),!0===Ia&&b.innerWidth<=767?Pa.classList.add("live-player__login"):Pa.classList.add("live-player__muted"),La.classList.contains("live-player--active")&&La.classList.remove("live-player--active"),Qa.classList.add("live-player__muted"),Ra.classList.contains("live-player__muted")&&(Ra.classList.remove("live-player__muted"),Ra.classList.add("resume__live")),Ra.classList.add("resume__audio"),$())}function q(){var b,d=c.querySelectorAll(".audio__time");for(b=0;b<d.length;++b)d[b].classList.add("playing");null!=Oa&&Oa.classList.add("audio__playing"),null!=Za&&Za.classList.add("audio__playing"),null!=Na&&Na.classList.add("playing"),null!=$a&&$a.classList.add("playing"),a(Wa).removeClass("-show"),a(Xa).addClass("-show"),lb.addClass("-show")}function r(b){var d,e=b.target,f=a(e).parents(".podcast-player"),g=e.parentNode,h=g.nextElementSibling,i=h.nextElementSibling,j=f.find(".podcast__play .audio__time"),k=c.querySelector(".podcast__runtime"),l=g.parentNode,m=l.nextElementSibling,n=m.querySelector(".audio__time");if(a(".playing__current").removeClass("playing__current"),null!=Va&&(La.classList.contains("single-show")||La.classList.contains("post-type-archive-podcast")||La.classList.contains("single-podcast")||La.classList.contains("home")))h.classList.add("playing__current"),i.classList.add("playing");else if(null==Va||(La.classList.contains("single-show")||La.classList.contains("post-type-archive-podcast")||La.classList.contains("single-podcast"))){for(d=0;d<j.length;++d)null!=j[d]&&(j[d].classList.add("playing"),j[d].classList.add("playing__current"));k.classList.add("playing")}else h.classList.add("playing__current"),n.classList.add("playing__current")}function s(){var a,b=c.querySelectorAll(".audio__time"),d=c.querySelectorAll(".podcast__runtime");for(a=0;a<b.length;++a)null!=b[a]&&b[a].classList.contains("playing")&&b[a].classList.remove("playing"),null!=b[a]&&b[a].classList.contains("playing__current")&&b[a].classList.remove("playing__current");for(null!=Oa&&Oa.classList.remove("audio__playing"),null!=Za&&Za.classList.remove("audio__playing"),null!=Na&&Na.classList.remove("playing"),a=0;a<d.length;++a)null!=d[a]&&d[a].classList.contains("playing")&&d[a].classList.remove("playing");null!=$a&&$a.classList.remove("playing")}function t(){null!=Pa&&Pa.classList.add("play-btn--heartbeat"),null!=Na&&Na.classList.add("live-player--heartbeat")}function u(){null!=Pa&&Pa.classList.contains("play-btn--heartbeat")&&Pa.classList.remove("play-btn--heartbeat"),null!=Na&&Na.classList.contains("live-player--heartbeat")&&Na.classList.remove("live-player--heartbeat")}function v(){cb=1,sa("-- Player Initialized By Click ---")}function w(){cb=!0,sa("-- Player Ready to Go ---")}function x(){Ia=!1,!0===cb&&(o(),b.innerWidth>=768?E():D())}function y(){null!=Pa&&f(Pa,"click",function(){!0===cb?(o(),x()):v()}),null!=Wa&&f(Wa,"click",function(){Ea||Ia||qb()})}function z(){var a=c.getElementById("live-stream__container");La.classList.add("vast-ad--playing"),null!=a&&a.classList.add("vast__pre-roll")}function A(){var a=c.getElementById("live-stream__container");La.classList.contains("vast-ad--playing")&&La.classList.remove("vast-ad--playing"),null!=a&&a.classList.remove("vast__pre-roll"),Cookies.set("gmr_play_live_audio",d),Cookies.set("gmr_play_live_audio",1,{expires:86400})}function B(){var b=parseInt(a(".audio-stream .audio-stream__title").attr("data-station-id"));if(isNaN(b)||!b)return void K();qa(),pa(),za.stop(),za.skipAd(),za.playAd("tap",{host:"cmod.live.streamtheworld.com",type:"preroll",format:"vast",stationId:b,trackingParameters:{dist:"debug"}}),setTimeout(a.proxy(za.skipAd,za),35e3)}function C(){var b=a.trim(a(".audio-stream .audio-stream__title").attr("data-callsign"));return b.length<1&&(b=gmr.callsign),b}function D(){var a=C();a&&(ua(),!0===Ia&&qb(),sa("playLiveStream - station="+a),B(),za.addEventListener?za.addEventListener("ad-playback-complete",K):za.attachEvent&&za.attachEvent("ad-playback-complete",K))}function E(){var a=C();a&&(ua(),!0===Ia?(wb(),n()):(sa("playLiveStream - station="+a),B(),za.addEventListener?za.addEventListener("ad-playback-complete",K):za.attachEvent&&za.attachEvent("ad-playback-complete",K)))}function F(){if(ua(),!0===Ia)wb(),n();else{var a=C();if(""===a)return;sa("playLiveStream - station="+a),Ea&&za.stop(),Na.classList.add("live-player--active"),e(a),n()}}function G(){!0===Ia?(yb(),j()):(Ka=!1,za.pause(),i()),Na.classList.contains("live-player--active")&&Na.classList.remove("live-player--active"),p()}function H(){if(""===a("#songHistoryCallsignUser").val())return void alert("Please enter a Callsign");var b="hdConnection"==a("#songHistoryConnectionTypeSelect").val();za.NowPlayingApi.load({mount:a("#songHistoryCallsignUser").val(),hd:b,numberToFetch:15})}function I(){za.MediaPlayer!==d&&(m(),za.addEventListener?(za.addEventListener("track-cue-point",X),za.addEventListener("ad-break-cue-point",aa),za.addEventListener("ad-break-synced-element",ba),za.addEventListener("stream-track-change",Y),za.addEventListener("hls-cue-point",Z),za.addEventListener("stream-status",ja),za.addEventListener("stream-geo-blocked",ka),za.addEventListener("timeout-alert",fa),za.addEventListener("timeout-reach",ga),za.addEventListener("stream-select",T),za.addEventListener("stream-start",S),za.addEventListener("stream-stop",U)):za.attachEvent&&(za.attachEvent("track-cue-point",X),za.attachEvent("ad-break-cue-point",aa),za.attachEvent("ad-break-synced-element",ba),za.attachEvent("stream-track-change",Y),za.attachEvent("hls-cue-point",Z),za.attachEvent("stream-status",ja),za.attachEvent("stream-geo-blocked",ka),za.attachEvent("timeout-alert",fa),za.attachEvent("timeout-reach",ga),za.attachEvent("stream-select",T),za.attachEvent("stream-start",S),za.attachEvent("stream-stop",U)),za.setVolume(1),la("Api Ready"),1===cb?(w(),x()):1===Cookies.get("gmlp_play_button_pushed")?(w(),x()):w(),b.innerWidth>=768&&(t(),setTimeout(u,2e3)),ma(za.MediaPlayer.tech.type),za.addEventListener?(za.addEventListener("list-loaded",ca),za.addEventListener("list-empty",da),za.addEventListener("nowplaying-api-error",ea)):za.attachEvent&&(za.attachEvent("list-loaded",ca),za.attachEvent("list-empty",da),za.attachEvent("nowplaying-api-error",ea)),a("#fetchSongHistoryByUserCallsignButton").click(function(){H()}),za.addEventListener?za.addEventListener("pwa-data-loaded",oa):za.attachEvent&&za.attachEvent("pwa-data-loaded",oa),a("#pwaButton").click(function(){na()}),bowser.ios?(Na.classList.add("no-volume-control"),fb.hide()):(fb.find('input[type="range"]').val(Q()).change(function(){db=parseFloat(a(this).val()),isNaN(db)&&(db=1),Ea&&za.setVolume(db),Ja&&(Ja.volume=db),"undefined"!=typeof localStorage&&localStorage.setItem("gmr-live-player-volume",db),R(db)}),gb.click(function(){fb.toggleClass("-open")})))}function J(a){sa("******** ad playback start **********"),sa(a),z(),Da=!0,la("Advertising... Type="+a.data.type)}function K(){var b=C();Da=!1,a("#td_adserver_bigbox").empty(),a("#td_adserver_leaderboard").empty(),la("Ready"),b&&(A(),sa("--- ad complete ---"),Ea&&za.stop(),La.classList.add("live-player--active"),Na.classList.add("live-player--active"),e(b),n())}function L(a){la("Ready"),A();var b=C();Ea&&za.stop(),Na.classList.add("live-player--active"),e(b),n()}function M(a){sa("Ad countdown : "+a.data.countDown+" second(s)")}function N(a){sa("Vast Process complete")}function O(a){sa("Vpaid Ad Companions"),P(a.companions)}function P(b){if(b&&b.length>0){var c=-1,d=-1;a.each(b,function(a,b){300==parseInt(b.width)&&250==parseInt(b.height)?c=a:728==parseInt(b.width)&&90==parseInt(b.height)&&(d=a)}),c>-1&&Fa.loadVASTCompanionAd("td_adserver_bigbox",b[c]),d>-1&&Fa.loadVASTCompanionAd("td_adserver_leaderboard",b[d])}}function Q(){var a=db;return"undefined"!=typeof localStorage&&(a=localStorage.getItem("gmr-live-player-volume"),null===a?a=1:(a=parseFloat(a),isNaN(a)&&(a=1))),R(a),a}function R(a){a=void 0!==a?a:1,0===a?gb.attr("class","audio-volume__btn -off"):a>0&&a<.33?gb.attr("class","audio-volume__btn -low"):a>.33&&a<.66?gb.attr("class","audio-volume__btn -medium"):a>.66&&gb.attr("class","audio-volume__btn")}function S(){Ea=!0,Ka=!0,Sa.classList.contains("loading")&&Sa.classList.remove("loading"),Qa.classList.contains("live-player__muted")&&Qa.classList.remove("live-player__muted"),g(),za.setVolume(Q())}function T(){a("#hasHQ").html(za.MediaPlayer.hasHQ().toString()),a("#isHQ").html(za.MediaPlayer.isHQ().toString()),a("#hasLow").html(za.MediaPlayer.hasLow().toString()),a("#isLow").html(za.MediaPlayer.isLow().toString())}function U(){Ea=!1,Ka=!1,a("#trackInfo").html(""),a("#asyncData").html(""),a("#hasHQ").html("N/A"),a("#isHQ").html("N/A"),a("#hasLow").html("N/A"),a("#isLow").html("N/A"),i()}function V(){ib.text(""),jb.text("")}function W(){V(),a(Wa).addClass("-show").text("On Air")}function X(b){var c=b.data&&b.data.cuePoint?b.data.cuePoint:{},d=parseInt(c.cueTimeDuration);sa("New Track cuepoint received"),sa("Title: "+c.cueTitle+" - Artist: "+c.artistName),$(),(c.cueTitle||c.artistName)&&(c.cueTitle&&ib.text(c.cueTitle),c.artistName&&jb.text(c.artistName),a(Wa).removeClass("-show")),c.nowplayingURL&&za.Npe.loadNpeMetadata(c.nowplayingURL,c.artistName,c.cueTitle),isNaN(d)||(bb&&clearTimeout(bb),d>6e4&&(bb=setTimeout(W,d))),a(La).trigger("liveAudioTrack.gmr")}function Y(a){sa("Stream Track has changed"),sa("Codec:"+a.data.cuePoint.audioTrack.codec()+" - Bitrate:"+a.data.cuePoint.audioTrack.bitRate())}function Z(a){sa("New HLS cuepoint received"),sa("Track Id:"+a.data.cuePoint.hlsTrackId+" SegmentId:"+a.data.cuePoint.hlsSegmentId)}function $(){mb.hide(),nb.hide()}function aa(a){var b=a.data&&a.data.adBreakData?a.data.adBreakData:{};sa("New Ad Break cuepoint was received"),sa("Title: "+b.cueTitle+" - URL: "+b.url+" - Duration: "+b.duration),W()}function ba(a){sa("Ad Break Synced Element"),b.innerWidth>=768?nb.show():mb.show(),setTimeout($,6e4)}function ca(b){sa("Song History loaded"),a("#asyncData").html('<br><p><span class="label label-warning">Song History:</span>');var c,d='<table class="table table-striped"><thead><tr><th>Song title</th><th>Artist name</th><th>Time</th></tr></thead>';a.each(b.data.list,function(a,b){c=new Date(Number(b.cueTimeStart)),d+="<tr><td>"+b.cueTitle+"</td><td>"+b.artistName+"</td><td>"+c.toLocaleTimeString()+"</td></tr>"}),d+="</table></p>",a("#asyncData").html("<div>"+d+"</div>")}function da(b){a("#asyncData").html('<br><p><span class="label label-important">Song History is empty</span>')}function ea(b){sa("Song History loading error",!0),a("#asyncData").html('<br><p><span class="label label-important">Song History error</span>')}function fa(a){sa("Time Out Alert")}function ga(a){sa("Time Out Reached")}function ha(a){sa("Configuration error",!0)}function ia(b){var c="";a.each(b.data.errors,function(a,b){c+="ERROR : "+b.data.error.message+"<br/>"}),a("#status").html('<p><span class="label label-important">'+c+"</span><p></p>")}function ja(a){switch(sa("tdplayer::onStatus"),sa("code: "+a.data.code),a.data.code){case"LIVE_PAUSE":eb.removeClass("-loading -playing"),eb.addClass("-paused");break;case"LIVE_PLAYING":eb.removeClass("-loading -paused"),eb.addClass("-playing");break;case"LIVE_STOP":case"LIVE_FAILED":eb.removeClass("-loading -playing"),eb.addClass("-paused");break;case"LIVE_BUFFERING":case"LIVE_CONNECTING":case"LIVE_RECONNECTING":eb.removeClass("-paused -playing"),eb.addClass("-loading");break;case"STREAM_GEO_BLOCKED":case"STATION_NOT_FOUND":eb.removeClass("-loading -playing"),eb.addClass("-paused")}la(a.data.status)}function ka(a){sa("tdplayer::onGeoBlocked"),la(a.data.text)}function la(b){sa(b),a("#status").html('<p><span class="label label-success">Status: '+b+"</span></p>")}function ma(b){var c=za.version.major+"."+za.version.minor+"."+za.version.patch+"."+za.version.flag,d='<p><span class="label label-info">Api version: '+c+" - Technology: "+b;za.flash.available&&(d+=" - Your current version of flash plugin is: "+za.flash.version.major+"."+za.flash.version.minor+"."+za.flash.version.rev),d+="</span></p>",a("#techInfo").html(d)}function na(){if(""===a("#pwaCallsign").val()||""===a("#pwaStreamId").val())return void alert("Please enter a Callsign and a streamid");za.PlayerWebAdmin.load(a("#pwaCallsign").val(),a("#pwaStreamId").val())}function oa(b){sa("PlayerWebAdmin data loaded successfully"),a("#asyncData").html('<br><p><span class="label label-warning">PlayerWebAdmin:</span>');var c='<table class="table table-striped"><thead><tr><th>Key</th><th>Value</th></tr></thead>';for(var d in b.data.config)c+="<tr><td>"+d+"</td><td>"+b.data.config[d]+"</td></tr>";c+="</table></p>",a("#asyncData").html("<div>"+c+"</div>")}function pa(){za.addEventListener?(za.addEventListener("ad-playback-start",J),za.addEventListener("ad-playback-error",L),za.addEventListener("ad-playback-complete",K),za.addEventListener("ad-countdown",M),za.addEventListener("vast-process-complete",N),za.addEventListener("vpaid-ad-companions",O)):za.attachEvent&&(za.attachEvent("ad-playback-start",J),za.attachEvent("ad-playback-error",L),za.attachEvent("ad-playback-complete",K),za.attachEvent("ad-countdown",M),za.attachEvent("vast-process-complete",N),za.attachEvent("vpaid-ad-companions",O))}function qa(){za.removeEventListener?(za.removeEventListener("ad-playback-start",J),za.removeEventListener("ad-playback-error",L),za.removeEventListener("ad-playback-complete",K),za.removeEventListener("ad-countdown",M),za.removeEventListener("vast-process-complete",N),za.removeEventListener("vpaid-ad-companions",O)):za.detachEvent&&(za.detachEvent("ad-playback-start",J),za.detachEvent("ad-playback-error",L),za.detachEvent("ad-playback-complete",K),za.detachEvent("ad-countdown",M),za.detachEvent("vast-process-complete",N),za.detachEvent("vpaid-ad-companions",O))}function ra(){for(var a,c=[],d=b.location.href.slice(b.location.href.indexOf("?")+1).split("&"),e=0;e<d.length;e++)a=d[e].split("="),c.push(a[0]),c[a[0]]=a[1];return c}function sa(a,c){gmr.debug&&b.console&&(c?console.error(a):console.info("["+(new Date).toLocaleString()+"]: "+a))}function ta(){if("undefined"!=typeof Modernizr&&Modernizr.audio){var b=c.querySelectorAll(".content"),d=a(b);d.on("click",".podcast__btn--play",function(b){var c=a(b.currentTarget);r(b),xb(c.attr("data-mp3-src")),tb(),Cb(c.attr("data-mp3-title"),c.attr("data-mp3-artist"),c.attr("data-mp3-hash"))}),d.on("click",".podcast__btn--pause",yb),lb.find('input[type="range"]').change(function(){if(Ja){var b=parseInt(Ja.duration);Ja.currentTime=Math.floor(b*parseFloat(a(this).val()))}})}else{var e=a(".gmr-mediaelement-fallback audio"),f=a(".podcast__play");e.mediaelementplayer(),f.hide()}}function ua(){a.support.pjax&&a(c).pjax("a:not(.ab-item)",".main",{fragment:".main",maxCacheLength:500,timeout:1e4})}function va(a){Ka||Ia||a.preventDefault()}function wa(){var a,b=c.querySelectorAll(".audio__progress"),d=0;for(a=0;a<b.length;++a)Ja.currentTime>0&&(d=Math.floor(100/Ja.duration*Ja.currentTime)),b[a].style.width=d+"%";lb.find('input[type="range"]').val(d/100)}function xa(){var a,b,c,d=parseInt(Ja.duration),e=parseInt(Ja.currentTime),f=new Date(2e3,1,1,0,0,0);isNaN(d)?d=e=0:isNaN(e)&&(e=0),f.setSeconds(d),a=f.getHours(),b=("0"+f.getMinutes()).slice(-2),c=("0"+f.getSeconds()).slice(-2),f=a>0?a+":"+b+":"+c:b+":"+c,lb.find("span:last").text(f)}function ya(){var a,b,c,d=parseInt(Ja.currentTime),e=new Date(2e3,1,1,0,0,0);e.setSeconds(isNaN(d)?0:d),a=e.getHours(),b=("0"+e.getMinutes()).slice(-2),c=("0"+e.getSeconds()).slice(-2),e=a>0?a+":"+b+":"+c:b+":"+c,lb.find("span:first").text(e)}var za,Aa,Ba,Ca,Da,Ea,Fa,Ga=a(b),Ha=a(c),Ia=(ra().tech,ra().aSyncCuePointFallback,!1),Ja=!1,Ka=!1,La=c.querySelector("body"),Ma=c.getElementById("td_container"),Na=c.getElementById("live-player"),Oa=c.querySelector(".live-stream__player"),Pa=c.getElementById("playButton"),Qa=c.getElementById("pauseButton"),Ra=c.getElementById("resumeButton"),Sa=c.getElementById("loadButton"),Ta=c.querySelector(".podcast__btn--play"),Ua=c.querySelector(".podcast__btn--pause"),Va=c.querySelector(".podcast-player"),Wa=c.getElementById("live-stream__listen-now"),Xa=c.getElementById("live-stream__now-playing"),Ya=(c.getElementById("live-stream__login"),a(c.getElementById("trackInfo"))),Za=(c.getElementById("clearDebug"),c.getElementById("on-air"),c.getElementById("live-stream__status")),$a=c.getElementById("nowPlaying"),_a=(c.getElementById("trackInfo"),c.querySelector(".live-player__stream"),null),ab=null,bb=null,cb=(c.querySelector(".footer"),!1),db=(a(c.getElementById("live-player--volume")),1),eb=a(c.getElementById("js-audio-controls")),fb=a(c.getElementById("js-audio-volume")),gb=a(c.getElementById("js-audio-volume-button")),hb=a(c.getElementById("js-audio-status")),ib=a(c.getElementById("js-track-info")),jb=a(c.getElementById("js-artist-info")),kb=a(c.getElementById("js-audio-expand")),lb=a(c.getElementById("js-audio-podcast")),mb=a(c.getElementById("js-audio-ad-aboveplayer")),nb=a(c.getElementById("js-audio-ad-inplayer")),ob=a(c.getElementById("js-audio-more")).find("a"),pb=a(c.getElementById("js-audio-status-listen"));a.fn.getComments=function(){return this.contents().map(function(){if(8===this.nodeType)return this.nodeValue}).get()},b.tdPlayerApiReady=function(){sa("--- TD Player API Loaded ---"),l()};var qb=function(){var a=Wa.textContent;!0===Ia&&(Ja.pause(),tb(),s(),Ia=!1,j()),"Listen Live"!==a&&(Wa.innerHTML="Listen Live"),x()};Ha.ready(function(){l(),y()}),Ga.on("click",function(){a(".audio-stream.-open").removeClass("-open")}),Ha.on("click",".audio-stream .audio-stream__title",function(b){b.stopPropagation();var c=a(this).parents(".audio-stream");Ia?(zb(),x()):c.is(".-multiple")&&c.toggleClass("-open")}),Ha.on("click",".audio-stream__item .audio-stream__link",function(b){var c=a(this),d=a.trim(c.find(".audio-stream__name").text()),e=a.trim(c.find(".audio-stream__desc").text()),f=c.attr("data-station-id"),g=c.parents(".audio-stream");b.stopPropagation(),g.removeClass("-open").find(".audio-stream__title").text(e&&e.length>0?e:d).attr("data-callsign",d).attr("data-station-id",f),kb.removeClass("-open"),ob.attr("href",ob.attr("data-tmpl").split("%s").join(d)),Ea&&(za.stop(),o()),!0===Ia?qb():x()}),kb.click(function(b){b.stopPropagation(),a(".audio-stream").toggleClass("-open"),a(this).toggleClass("-open")});var rb=a(".live-player__stream--current-name");rb.bind("DOMSubtreeModified",function(){sa("--- new stream select ---");var a=rb.text();Ea&&za.stop(),!0===Ia&&qb(),e(a),Na.classList.add("live-player--active"),n()});var sb=function(){void 0!==za&&void 0!==za.stop&&za.stop()},tb=function(){a(".podcast__btn--play.playing").removeClass("playing"),a(".podcast__btn--pause.playing").removeClass("playing")},ub=function(){var b=".mp3-"+Ca;a(b+" .podcast__btn--play").addClass("playing"),a(b+" .podcast__btn--pause").addClass("playing")},vb=function(a){Ja.src=a},wb=function(){Ia=!0,sb(),Ja&&Ja.duration==Ja.currentTime&&(Ja.currentTime=0),Ja.play(),Ja.volume=Q(),Ab(),Bb(),tb(),n(),ub(),q(),h()},xb=function(a){ua(),Ia=!0,a!==Ja.src&&vb(a),wb()},yb=function(){Ja.pause()},zb=function(){Ja.pause(),tb(),Ia=!1,o(),s(),j()},Ab=function(){var b=_.template('<div class="now-playing__title"><%- title %></div>'),c=a(".now-playing__title");c.length>0?c.html('<div class="audio__title">'+Ba+'</div><div class="audio__time"><span class="audio__time--inline">(</span><div class="audio__time--elapsed"></div><span class="audio__time--inline"> / </span><div class="audio__time--remaining"></div><span class="audio__time--inline">)</span></div>'):Ya.prepend(b({title:Ba})),ib.text(Ba),jb.text("")},Bb=function(){var b=_.template('<div class="now-playing__artist"><%- artist %></div>'),c=a(".now-playing__artist");c.length>0?c.text(Aa):Ya.append(b({artist:Aa}))},Cb=function(a,b,c){Ba=a,Aa=b,Ca=c,Ab(),Bb(),ub()};Ha.bind("pjax:click",va),a(".audio__progress-bar").click(function(b){var c=a(this),d=c.width(),e=c.offset(),f=b.pageX-e.left,g=Math.floor(f/d*Ja.duration);Ja.currentTime=g}),function(){if("undefined"!=typeof Modernizr&&Modernizr.audio){b.customAudio=Ja=new Audio;var a=function(){tb(),p(),j()},c=function(){Ia=!1,tb(),o(),j()};Ja.addEventListener?(Ja.addEventListener("pause",a),Ja.addEventListener("ended",c)):Ja.attachEvent&&(Ja.attachEvent("pause",a),Ja.attachEvent("ended",c))}}(),ta(),Ja.addEventListener("timeupdate",function(){wa(),ya(),xa()},!1),f(Ta,"click",q),f(Ua,"click",yb),Ha.on("pjax:end",function(){ta(),ub(),f(Ta,"click",q),f(Ua,"click",yb)})}(jQuery,window,document);