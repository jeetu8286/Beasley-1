/*! Greater Media Contests - v1.0.6
 * http://10up.com/
 * Copyright (c) 2016;
 * Licensed GPLv2+
 */
!function(a){var b,c,d=a.event;b=d.special.debouncedresize={setup:function(){a(this).on("resize",b.handler)},teardown:function(){a(this).off("resize",b.handler)},handler:function(a,e){var f=this,g=arguments,h=function(){a.type="debouncedresize",d.dispatch.apply(f,g)};c&&clearTimeout(c),e?h():c=setTimeout(h,b.threshold)},threshold:250}}(jQuery);var BLANK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";!function(a){a.fn.imagesLoaded=function(b){function c(){var c=a(j),d=a(k);f&&(k.length?f.reject(h,c,d):f.resolve(h)),a.isFunction(b)&&b.call(e,h,c,d)}function d(b,d){b.src!==BLANK&&-1===a.inArray(b,i)&&(i.push(b),d?k.push(b):j.push(b),a.data(b,"imagesLoaded",{isBroken:d,src:b.src}),g&&f.notifyWith(a(b),[d,h,a(j),a(k)]),h.length===i.length&&(setTimeout(c),h.unbind(".imagesLoaded")))}var e=this,f=a.isFunction(a.Deferred)?a.Deferred():0,g=a.isFunction(f.notify),h=e.find("img").add(e.filter("img")),i=[],j=[],k=[];return a.isPlainObject(b)&&a.each(b,function(a,c){"callback"===a?b=c:f&&f[a](c)}),h.length?h.bind("load.imagesLoaded error.imagesLoaded",function(a){d(a.target,"error"===a.type)}).each(function(b,c){var e=c.src,f=a.data(c,"imagesLoaded");return f&&f.src===e?void d(c,f.isBroken):c.complete&&void 0!==c.naturalWidth?void d(c,0===c.naturalWidth||0===c.naturalHeight):void((c.readyState||c.complete)&&(c.src=BLANK,c.src=e))}):c(),f?f.promise(e):e}}(jQuery),function(a,b,c){var d,e=a(window),f=a("html, body"),g={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},h=g[b.prefixed("transition")],i=b.csstransitions;a.fn.grid=function(b){var g=a(this),j=a("#wpadminbar").height()||0,k={minHeight:816,speed:200,easing:"ease",loadMore:null,loadMoreWaypointOffset:"150%",loadMoreUrl:null,loadedMore:null,previewLoaded:null};return k=a.extend(!0,{},k,b),g.each(function(){function b(){t.imagesLoaded(function(){m(!0),p(),n()})}function g(b){u=u.add(b),b.each(function(){var b=a(this);b.data({offsetTop:b.offset().top,height:b.height()})}),o(b)}function l(){var b;if(a.isFunction(k.loadMoreUrl)){if(C)return;if(b=k.loadMoreUrl(B),!b)return;C=!0,B++,v.addClass("loading"),a.get(b,function(b){var d=a(a.trim(b));d.length>0?(t.append(d),g(d),d.length>=A?(C=!1,v.removeClass("loading"),c.refreshAll(),a.isFunction(k.loadedMore)&&k.loadedMore(d)):v.hide()):v.hide()})}}function m(b){u.each(function(){var c=a(this);c.data("offsetTop",c.offset().top),b&&c.data("height",c.outerHeight())})}function n(){o(u),e.on("debouncedresize",function(){y=0,x=-1,m(),p();var b=a.data(this,"preview");"undefined"!=typeof b&&r()}),v.length>0&&(v.on("click",function(){return l(),!1}),v.waypoint({offset:k.loadMoreWaypointOffset,triggerOnce:!1,handler:function(a){"down"===a&&l()}}),c.refreshAll())}function o(b){b.on("click","span.preview-close",function(){return r(),!1}),b.on("click","> a",function(b){var c=a(this).parent();return w===c.index()?r():q(c),!1})}function p(){d={width:e.width(),height:e.height()}}function q(b){var c=a.data(this,"preview"),d=b.data("offsetTop");if(y=0,"undefined"!=typeof c){if(x===d)return c.update(b),!1;d>x&&(y=c.height),r()}x=d,c=a.data(this,"preview",new s(b)),c.open()}function r(){var b=a.data(this,"preview");w=-1,b&&b.close(),a.removeData(this,"preview")}function s(a){this.$item=a,this.expandedIdx=this.$item.index(),this.create(),this.update()}var t=a(this),u=t.children("li"),v=a(k.loadMore),w=-1,x=-1,y=0,z=70,A=u.length,B=1,C=!1;s.prototype={create:function(){this.$closePreview=a('<span class="preview-close"></span>'),this.$previewInner=a('<div class="preview-inner"></div>').append(this.$closePreview),this.$previewEl=a('<div class="preview"></div>').append(this.$previewInner),this.$item.append(this.getEl()),i&&this.setTransition()},update:function(b){var c,d,e,f;if(f=this,b&&(f.$item=b,f.getEl().appendTo(b)),-1!==w){var g=u.eq(w);g.removeClass("expanded"),f.$item.addClass("expanded"),f.positionPreview()}w=f.$item.index(),c=f.$previewInner,c.html(f.$closePreview),d=f.$item.children("a"),e=d.data("content"),e?(c.append(e),a.isFunction(k.previewLoaded)&&k.previewLoaded(f)):a.get(d.attr("href"),{ajax:"true"},function(b){d.data("content",b),c.append(b),a.isFunction(k.previewLoaded)&&k.previewLoaded(f)})},open:function(){setTimeout(a.proxy(function(){this.setHeights(),this.positionPreview()},this),25)},close:function(){var b=this,c=function(){i&&a(this).off(h),b.$item.removeClass("expanded"),b.$previewEl.remove()};return setTimeout(a.proxy(function(){"undefined"!=typeof this.$largeImg&&this.$largeImg.fadeOut("fast"),this.$previewEl.css("height",0);var a=u.eq(this.expandedIdx);a.css("height",a.data("height")).on(h,c),i||c.call()},this),25),!1},calcHeight:function(){var a=d.height-this.$item.data("height")-z,b=d.height;a<k.minHeight&&(a=k.minHeight,b=k.minHeight+this.$item.data("height")+z),this.height=a,this.itemHeight=b},setHeights:function(){var a=this,b=function(){i&&a.$item.off(h),a.$item.addClass("expanded")};this.calcHeight(),this.$previewEl.css("height",this.height),this.$item.css("height",this.itemHeight).on(h,b),i||b.call()},positionPreview:function(){var a,b=this.$item.data("offsetTop"),c=this.$previewEl.offset().top-y;a=this.height+this.$item.data("height")+z<=d.height?b:this.height<d.height?c-(d.height-this.height):c,f.animate({scrollTop:a-j},k.speed)},setTransition:function(){this.$previewEl.css("transition","height "+k.speed+"ms "+k.easing),this.$item.css("transition","height "+k.speed+"ms "+k.easing)},getEl:function(){return this.$previewEl}},b()}),g}}(jQuery,Modernizr,Waypoint),function(a){var b,c,d=a(document),e=function(a,b){var c=parseInt(a.text().replace(/\D+/g,""));isNaN(c)&&(c=0),c+=b,c=c.toFixed(2).replace(/\d(?=(\d{3})+\.)/g,"$&,").replace(/\..*/g,""),a.text(c)},f=function(c){var f=c.$previewInner,g=c.$item,h=g.find(".contest__submission--rating b"),i=!1;a.fn.cycle&&f.find(".cycle-slideshow").cycle(),f.find(".contest__submission--vote").click(function(){var c=a(this),d=c.find("i.gmr-icon"),f=d.attr("class");return i||(i=!0,d.attr("class","gmr-icon icon-spin icon-spin"),a.post(b.data("vote"),{ugc:c.data("id")},function(a){i=!1,d.attr("class",f),a.success&&(g.addClass("voted"),e(h,1))})),!1}),f.find(".contest__submission--unvote").click(function(){var c=a(this),d=c.find("i.gmr-icon"),f=d.attr("class");return i||(i=!0,d.attr("class","gmr-icon icon-spin icon-spin"),a.post(b.data("unvote"),{ugc:c.data("id")},function(a){i=!1,d.attr("class",f),a.success&&(g.removeClass("voted"),e(h,-1))})),!1}),d.trigger("contest:preview-loaded")},g=function(a){return b.data("infinite")+(a+1)+"/"},h=function(){b=a("#contest-form"),c=a(".contest__submissions--list"),d.on("submit","#contest-form form",function(){var c,d,e=a(this);return!e.parsley||e.parsley().isValid()?(e.find("input, textarea, select, button").attr("readonly","readonly"),e.find("i.gmr-icon").show(),d=function(){var d=c.contentDocument||c.contentWindow.document,f=d.getElementsByTagName("body")[0],g=b.offset().top-a("#wpadminbar").height()-10;f=a.trim(f.innerHTML),f.length>0?b.html(f):(alert("Your submission failed. Please, enter required fields and try again."),e.find("input, textarea, select, button").removeAttr("readonly"),e.find("i.gmr-icon").hide()),a("html, body").animate({scrollTop:g},200)},c=document.getElementById("theiframe"),c.addEventListener?c.addEventListener("load",d,!1):c.attachEvent&&c.attachEvent("onload",d),!0):!1});var e=function(b){var c=a(".contest__restrictions");c.attr("class","contest__restrictions"),b&&c.addClass(b)},h=function(c){a.get(c,function(c){var d=null;c.success?(b.html(c.data.html),a("#contest-form form").parsley(),a(".type-contest.collapsed").removeClass("collapsed")):d=c.data.restriction,e(d),c.data&&c.data.contest_id&&i(c.data.contest_id)})},i=function(b){if(is_gigya_user_logged_in())get_gigya_profile_fields(["email","dateOfBirth"]).then(j);else{var c=a(".contest__form--user-info");c.css("display","block")}},j=function(a){a.success&&k(a.data)},k=function(b){var c='<span class="meta-title">Entry Details</span><a href="<%- editProfileUrl %>">Edit Your Profile</a><p class="meta-subtitle">This information is required for every entry.</p><dl><dt>Name: </dt><dd><%- firstName %> <%- lastName %></dd><dt>Email Address:</dt><dd><%- email %></dd><dt>Date of Birth: </dt><dd><%- dateOfBirth %></dd><dt>Zip: </dt><dd><%- zip %></dd></dl>',d={editProfileUrl:gigya_profile_path("account"),loginUrl:gigya_profile_path("login"),firstName:get_gigya_user_field("firstName"),lastName:get_gigya_user_field("lastName"),email:b.email||"N/A",age:get_gigya_user_field("age"),dateOfBirth:b.dateOfBirth||"N/A",zip:get_gigya_user_field("zip")},e=_.template(c),f=e(d),g=a(".contest__form--user-info .user-info-box");g.html(f),g.css("display","block");var h=a(".contest__form--user-info");h.css("display","block")};a(".contest__restriction--min-age-yes").click(function(){return h(b.data("confirm-age")),!1}),a(".contest__restriction--min-age-no").click(function(){return e("age-fails"),!1}),b.length>0&&h(b.data("load")),c.length>0&&c.grid({loadMore:".contest__submissions--load-more",previewLoaded:f,loadMoreUrl:g})};d.bind("pjax:end",h).ready(h)}(jQuery),function(a){a(document).ready(function(){function b(){var a=document.createElement("input"),b=document.documentElement,c={},d=":)";return function(e){for(var f,g,h,i=0,j=e.length;j>i;i++)a.setAttribute("type",g=e[i]),f="text"!==a.type,f&&(a.value=d,a.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(g)&&void 0!==a.style.WebkitAppearance?(b.appendChild(a),h=document.defaultView,f=h.getComputedStyle&&"textfield"!==h.getComputedStyle(a,null).WebkitAppearance&&0!==a.offsetHeight,b.removeChild(a)):/^(search|tel)$/.test(g)||(f=/^(url|email)$/.test(g)?a.checkValidity&&a.checkValidity()===!1:a.value!==d)),c[e[i]]=!!f;return c}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var c=b();c.hasOwnProperty("date")&&!1!==c.date||(a("input[type=date]").datetimepicker({timepicker:!1,format:"m/d/Y"}),a("input[type=time]").datetimepicker({datepicker:!1,format:"g:i A",formatTime:"g:i A",allowTimes:["12:00 AM","12:30 AM","1:00 AM","1:30 AM","2:00 AM","2:30 AM","3:00 AM","3:30 AM","4:00 AM","4:30 AM","5:00 AM","5:30 AM","6:00 AM","6:30 AM","7:00 AM","7:30 AM","8:00 AM","8:30 AM","9:00 AM","9:30 AM","10:00 AM","10:30 AM","11:00 AM","11:30 AM","12:00 PM","12:30 PM","1:00 PM","1:30 PM","2:00 PM","2:30 PM","3:00 PM","3:30 PM","4:00 PM","4:30 PM","5:00 PM","5:30 PM","6:00 PM","6:30 PM","7:00 PM","7:30 PM","8:00 PM","8:30 PM","9:00 PM","9:30 PM","10:00 PM","10:30 PM","11:00 PM","11:30 PM"]}))})}(jQuery);